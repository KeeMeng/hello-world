<!DOCTYPE html>
<html>
	<<title>SI Prefix Converter</title>
	<body style="text-align: center; font-family: Futura; font-weight: bold;">
		<script type="text/javascript">
			var char_array = ["T", "G", "M", "k", "h", "da", "_", "d", "c", "m", "u", "n", "p"];
			var power_array = [12,9,6,3,2,1,0,-1,-2,-3,-6,-9,-12];
			var name_array = ["tera", "giga", "mega", "kilo", "hecto", "deca", "", "deci", "centi", "milli", "micro", "nano", "pico"];
			function set_output() {
				let re = new RegExp("^(eg. )?([0-9]*) ?(T|G|M|k|h|da|_|d|c|m|u|n|p|)?([0-9])?([a-zA-Z ]*) (T|G|M|k|h|da|_|d|c|m|u|n|p|)([0-9])?");
				let match = document.getElementById("input_text").value.match(re);
				// document.getElementById("debug").innerHTML = match;
				if (match !== null && (match[3] == undefined || char_array.includes(match[3])) && (match[6] == undefined || char_array.includes(match[6])) && (match[4] == match[7] || match[4] == "" || match[7] !== "")) {
					if (match[3] == undefined) {
						x_power = 0;
						x_name = "";
					}
					else {
						x = match[3];
						x_power = power_array[char_array.indexOf(x)];
						x_name = name_array[char_array.indexOf(x)];
					}
					if (match[6] == undefined) {
						y_power = 0;
						y_name = "";
					}
					else {
						y = match[6];
						y_power = power_array[char_array.indexOf(y)];
						y_name = name_array[char_array.indexOf(y)];
					}
					if (match[2] == "") {
						num = 1;
					}
					else {
						num = match[2];
					}

					if (match[4] !== undefined || match[7] !== undefined) {
						if (match[7] !== undefined) {
							number = num * (10 ** ((x_power - y_power) * match[7]));
							extra = match[7];
						}
						else if (match[4] !== undefined) {
							number = num * (10 ** ((x_power - y_power) * match[4]));
							extra = match[4];
						}
						if (x_name == "") {
							document.getElementById("output").innerHTML = num + " = " + number + " " + y_name + "^" + extra;
						}
						else if (y_name == "") {
							document.getElementById("output").innerHTML = num + x_name + "^" + extra + " = " + number;
						}
						else {
							document.getElementById("output").innerHTML = num + x_name + "^" + extra + " = " + number + " " + y_name + "^" + extra;
						}
					}
					else {
						number = num * 10 ** (x_power - y_power);
						document.getElementById("output").innerHTML = num + " " + x_name + " = " + number + " " + y_name;
					}
					if (x_name !== "") {
						document.getElementById("xvalue").innerHTML = "Unit 1 (" + x_name + "): " + 10 ** x_power;
					}
					else {
						document.getElementById("xvalue").innerHTML = "Unit 1: " + 10 ** x_power;
					}
					if (y_name !== "") {
						document.getElementById("yvalue").innerHTML = "Unit 2 (" + y_name + "): " + 10 ** y_power;
					}
					else {
						document.getElementById("yvalue").innerHTML = "Unit 2: " + 10 ** y_power;
					}
				}
				else {
					document.getElementById("output").innerHTML = "";
					document.getElementById("xvalue").innerHTML = "";
					document.getElementById("yvalue").innerHTML = "";
				}
			}
			setInterval(set_output, 0);

			document.body.classList.toggle("lightmode");
			var dark = false;
			function dark_mode() {
				dark = !dark;
				document.body.classList.toggle("darkmode");
				document.body.classList.toggle("lightmode");
			}

			var index = 0;
			function example() {
				eg = ["eg. 1 to k","eg. M to _","eg. 5c d","eg. 1 d3","eg. d3 to _","eg. 4_ c2","eg. h m","eg. G T"]
				// index = Math.floor(Math.random() * Math.floor(7))
				document.getElementById("input_text").value = eg[index];
				index ++;
				if (index > 7) {
					index = 0;
				}
			}

		</script>

		<style>
			.darkmode {
				background-color: black;
				color: white;
				transition: 0.5s;
				border-color: white;
			}

			.lightmode {
				background-color: white;
				color: black;
				transition: 0.5s;
				border-color: black;
			}

			.textbox {
				border-radius: 1em;
				border-width: 5px;
				background-color: inherit;
				color: inherit;
				border-color: inherit;

				-webkit-transform: perspective(1px);
				transform: perspective(1px);
				-webkit-transition-duration: 0.2s;
				transition-duration: 0.2s;
				-webkit-transition-property: transform;
				transition-property: transform;
			}
			.textbox:hover, .textbox:active {
				-webkit-transform: scale(1.05);
				transform: scale(1.05);
			}
		</style>

		<center style="font-size: 64px" onmousedown="dark_mode()">Converter</center>
		<button style="font-family: Futura; font-size: 16px; background-color: inherit; color:inherit; border-color: inherit; border-radius: 1em" onmousedown="example()">Click for Example</button>
		<p style="font-size: 32;">Units: T, G, M, k, h, da, _ (1), d, c, m , u, n, p</p>
		<input class="textbox" type="text" id="input_text" style="font-family: Futura; font-size: 32px; text-align: center" onfocus="this.value=''">
		<p style="font-size: 4px;"></p>
		<span id="output" style="font-weight: normal; font-size: 32px;"></span>
		<br>
		<span id="xvalue" style="font-weight: normal; font-size: 32px;"></span>
		<br>
		<span id="yvalue" style="font-weight: normal; font-size: 32px;"></span>
		<br>
		<span id="debug" style="font-weight: normal; font-size: 32px;"></span>
		<br>
	</body>
</html>